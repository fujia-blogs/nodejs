# 主流框架

1. express.js

2. koa

3. egg.js

4. nest.js

## 洋葱模型

1. 掌握这个概念，当前各种框架的原理学习都会驾轻就熟。

2. 无论是那个 node.js 框架，都是基于中间件来实现的，而中间件(一个类或函数模块)的执行方式就需要依据洋葱模型。

3. express 和 koa 之间的区别也在于洋葱模型的执行方式上。

4. 洋葱的表皮可以思考为**中间件：**

- 从外向内的过程是一个关键字 next()
- 从内向外则是每个中间件执行完毕后，进入下一层中间件，一直到最后一层。

### express

1. Express 框架出来⽐较久了，它在 Node.js 初期就是⼀个热度较⾼、成熟的 Web 框架，并且包括的应⽤场景⾮常⻬全。同时基于 Express，也诞⽣了⼀些场景型的框架，常⻅的就如上⾯我们提到的 Nest.js 框架。

2. express VS. koa

- Express 封装、内置了很多中间件，⽐如 connect 和 router ，⽽ KOA 则⽐较轻量，开发者可以根据⾃身需求定制框架；
- express 基于 callback 处理中间件，koa 基于 await/async
- 异步执行中间件时，express 并非严格按照洋葱模型执行中间件，而 koa 是严格遵循的。

### koa

1. 注意，如果需要确保中间件的执⾏顺序，必须使⽤ await next()。

### egg.js

1. KOA 是⼀个可定制的框架，开发者可以根据⾃⼰的需要，定制各种机制，⽐如多进程处理、路由处理、上下⽂ context 的处理、异常处理等，⾮常灵活。⽽ Egg.js 就是在 KOA 基础上，做了各种⽐较成熟的中间件和模块，可以说是在 KOA 框架基础上的最佳实践，⽤以满⾜开发者开箱即⽤的特性。
